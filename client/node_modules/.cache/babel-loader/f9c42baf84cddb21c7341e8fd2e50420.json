{"ast":null,"code":"import { actionTypes } from '../actionTypes';\nimport axios from '../../Axios/config';\nimport { setCurrentUser, getCurrentUser, setCurrentToken } from '../../UtilityFunctions/functions';\nimport { loading, finishedLoading } from './loadingActions';\n\nconst updateWifiDetails = (username, password) => async dispatch => {\n  dispatch(loading());\n\n  try {\n    const user = await axios.post('/wifi', {\n      email: getCurrentUser().email,\n      wifiUsername: username,\n      wifiPassword: password\n    });\n    dispatch(updateUsername(user.data));\n  } catch (error) {\n    dispatch(openPrompt('תקלה', error.response));\n  } finally {\n    dispatch(finishedLoading());\n  }\n};\n\nconst updateSettings = (shufersalUsername, shufersalPassword, ramiLevyUsername, ramiLevyPassword, selection, sound) => async dispatch => {\n  dispatch(loading());\n\n  try {\n    const user = await axios.post('/settings', {\n      email: getCurrentUser().email,\n      shufersalUsername,\n      shufersalPassword,\n      ramiLevyUsername,\n      ramiLevyPassword,\n      selection,\n      sound\n    });\n    await dispatch(updateUsername(user.data));\n    await dispatch(loggedIn());\n    dispatch(openPrompt('נשמר', 'כל המידע נשמר'));\n  } catch (error) {\n    console.log(error);\n    dispatch(openPrompt('תקלה', error.response.data));\n  } finally {\n    dispatch(finishedLoading());\n  }\n};\n\nconst updateUsername = user => dispatch => {\n  setCurrentUser(user);\n\n  try {\n    if (user.token !== undefined && user.token !== null && user.token !== '') {\n      setCurrentToken(user.token);\n      dispatch(updateToken(user.token));\n    }\n  } catch (erorr) {\n    console.log(erorr);\n  }\n\n  return {\n    type: actionTypes.UPDATE_USERNAME,\n    payload: user\n  };\n};\n\nconst openPrompt = (title, text, subjectOptional) => {\n  return {\n    type: actionTypes.OPEN_PROMPT,\n    title,\n    text,\n    subjectOptional\n  };\n};\n\nconst loggedIn = () => {\n  return {\n    type: actionTypes.LOGGED_IN\n  };\n};\n\nconst updateToken = token => {\n  return {\n    type: actionTypes.UPDATE_TOKEN,\n    token\n  };\n};\n\nconst logIn = (email, password) => async dispatch => {\n  dispatch(loading());\n\n  try {\n    const user = await axios.post('/login', {\n      email: email,\n      password: password\n    });\n    await dispatch(updateUsername(user.data));\n    await dispatch(loggedIn());\n  } catch (error) {\n    dispatch(openPrompt('תקלה', error.response));\n  } finally {\n    dispatch(finishedLoading());\n  }\n};\n\nconst registerAll = (email, password, shufersalUsername, shufersalPassword, ramiLevyUsername, ramiLevyPassword, selection, sound, usernameWifi, passwordWifi) => async dispatch => {\n  const shouldUpdate = await axios.post('/settings/update', {\n    shufersalUsername,\n    shufersalPassword,\n    ramiLevyUsername,\n    ramiLevyPassword,\n    selection\n  });\n  console.log(shouldUpdate.data.should);\n\n  if (shouldUpdate.data.should) {\n    await dispatch(register(email, password));\n\n    if (getCurrentUser()) {\n      await dispatch(updateWifiDetails(usernameWifi, passwordWifi));\n      await dispatch(updateSettings(shufersalUsername, shufersalPassword, ramiLevyUsername, ramiLevyPassword, selection, sound));\n    }\n  } else {\n    dispatch(openPrompt('תקלה', 'שם משתמש וסיסמה לאתר הקניות לא נמצאו'));\n  }\n};\n\nconst register = (email, password) => async dispatch => {\n  dispatch(loading());\n\n  try {\n    const user = await axios.post('/register', {\n      email: email,\n      password: password\n    });\n    await dispatch(updateUsername(user.data));\n  } catch (error) {\n    console.log(error);\n    dispatch(openPrompt('תקלה', error.response.data));\n  } finally {\n    dispatch(finishedLoading());\n  }\n};\n\nexport { updateUsername, loggedIn, logIn, register, updateWifiDetails, updateSettings, updateToken, registerAll };","map":{"version":3,"sources":["C:/Users/avivk/Documents/GitHub/scanlyreal/client/src/Store/Actions/mainActions.js"],"names":["actionTypes","axios","setCurrentUser","getCurrentUser","setCurrentToken","loading","finishedLoading","updateWifiDetails","username","password","dispatch","user","post","email","wifiUsername","wifiPassword","updateUsername","data","error","openPrompt","response","updateSettings","shufersalUsername","shufersalPassword","ramiLevyUsername","ramiLevyPassword","selection","sound","loggedIn","console","log","token","undefined","updateToken","erorr","type","UPDATE_USERNAME","payload","title","text","subjectOptional","OPEN_PROMPT","LOGGED_IN","UPDATE_TOKEN","logIn","registerAll","usernameWifi","passwordWifi","shouldUpdate","should","register"],"mappings":"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","sourcesContent":["import { actionTypes } from '../actionTypes'\r\nimport axios from '../../Axios/config'\r\nimport { setCurrentUser,getCurrentUser, setCurrentToken } from '../../UtilityFunctions/functions'\r\nimport { loading, finishedLoading } from './loadingActions'\r\n\r\nconst updateWifiDetails = (username, password) => async dispatch => {\r\n    dispatch(loading());\r\n    try{\r\n        const user = await axios.post('/wifi',{email:getCurrentUser().email,wifiUsername: username,wifiPassword: password })\r\n        dispatch(updateUsername(user.data));\r\n    }\r\n    catch(error){\r\n        dispatch(openPrompt('תקלה', error.response))\r\n    }\r\n    finally{\r\n        dispatch(finishedLoading());\r\n    }\r\n}\r\n\r\nconst updateSettings = (shufersalUsername,shufersalPassword,ramiLevyUsername,ramiLevyPassword,selection,sound) => async dispatch => {\r\n    dispatch(loading());\r\n    try{\r\n        const user = await axios.post('/settings',\r\n        {email:getCurrentUser().email,\r\n            shufersalUsername,\r\n            shufersalPassword,\r\n            ramiLevyUsername,\r\n            ramiLevyPassword,\r\n            selection,\r\n            sound\r\n         })\r\n        await dispatch(updateUsername(user.data));\r\n        await dispatch(loggedIn());\r\n        dispatch(openPrompt('נשמר','כל המידע נשמר'))\r\n    }\r\n    catch(error){\r\n        console.log(error)\r\n        dispatch(openPrompt('תקלה', error.response.data))\r\n    }\r\n    finally{\r\n        dispatch(finishedLoading());\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\nconst updateUsername = (user) => dispatch => {\r\n    setCurrentUser(user);\r\n    try{\r\n        if(user.token !== undefined && user.token !== null && user.token !== ''){\r\n            setCurrentToken(user.token)\r\n            dispatch(updateToken(user.token))    \r\n        }\r\n    }\r\n    catch(erorr){\r\n        console.log(erorr)\r\n    }\r\n    return {\r\n        type: actionTypes.UPDATE_USERNAME,\r\n        payload: user\r\n    }\r\n}\r\n\r\nconst openPrompt = (title, text, subjectOptional) => {\r\n    return {\r\n        type: actionTypes.OPEN_PROMPT,\r\n        title,\r\n        text,\r\n        subjectOptional\r\n    }\r\n}\r\n\r\n\r\nconst loggedIn = () => {\r\n    return {\r\n        type: actionTypes.LOGGED_IN\r\n    }\r\n}\r\n\r\nconst updateToken = (token) => {\r\n    return {\r\n        type: actionTypes.UPDATE_TOKEN,\r\n        token,\r\n    }\r\n}\r\n\r\nconst logIn = (email, password) => async dispatch => {\r\n    dispatch(loading());\r\n    try {\r\n        const user = await axios.post('/login', { email: email, password: password })\r\n        await dispatch(updateUsername(user.data));\r\n        await dispatch(loggedIn());\r\n    }\r\n    catch (error) {\r\n        dispatch(openPrompt('תקלה', error.response))\r\n    }\r\n    finally {\r\n        dispatch(finishedLoading());\r\n    }\r\n}\r\n\r\nconst registerAll = (email,password,shufersalUsername,shufersalPassword,ramiLevyUsername,ramiLevyPassword,selection,sound,usernameWifi,passwordWifi) => async dispatch => {\r\n    const shouldUpdate = await axios.post('/settings/update', {shufersalUsername,shufersalPassword,ramiLevyUsername,ramiLevyPassword,selection})\r\n    console.log(shouldUpdate.data.should)\r\n    if(shouldUpdate.data.should){\r\n        await dispatch(register(email,password))\r\n        if(getCurrentUser()){\r\n            await dispatch(updateWifiDetails(usernameWifi,passwordWifi))        \r\n            await dispatch(updateSettings(shufersalUsername,shufersalPassword,ramiLevyUsername,ramiLevyPassword,selection,sound))\r\n        }    \r\n    }\r\n   else{\r\n       dispatch(openPrompt('תקלה', 'שם משתמש וסיסמה לאתר הקניות לא נמצאו'))\r\n   }\r\n}\r\n\r\nconst register = (email, password) => async dispatch => {\r\n    dispatch(loading());\r\n    try {\r\n        const user = await axios.post('/register', { email: email, password: password })\r\n        await dispatch(updateUsername(user.data));\r\n    }\r\n    catch (error) {\r\n        console.log(error)\r\n        dispatch(openPrompt('תקלה', error.response.data))\r\n    }\r\n    finally {\r\n        dispatch(finishedLoading());\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport {\r\n    updateUsername,\r\n    loggedIn,\r\n    logIn,\r\n    register,\r\n    updateWifiDetails,\r\n    updateSettings,\r\n    updateToken,\r\n    registerAll\r\n}\r\n"]},"metadata":{},"sourceType":"module"}