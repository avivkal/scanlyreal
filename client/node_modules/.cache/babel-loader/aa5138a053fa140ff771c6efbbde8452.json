{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/avivk/Documents/GitHub/scanlyreal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/avivk/Documents/GitHub/scanlyreal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/avivk/Documents/GitHub/scanlyreal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/avivk/Documents/GitHub/scanlyreal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/avivk/Documents/GitHub/scanlyreal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/avivk/Documents/GitHub/scanlyreal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{Component}from'react';import{connect}from'react-redux';import*as mainActions from'../../Store/Actions/mainActions';import*as promptActions from'../../Store/Actions/promptActions';import*as loadingActions from'../../Store/Actions/loadingActions';import{LOGIN_PATH}from'../../Constants/const';import{getCurrentUser}from'../../UtilityFunctions/functions';import{Container,Dropdown,Table,Spinner}from'react-bootstrap';import axios from'axios';import'./dashboard.scss';import{finishedLoading}from'../../Store/Actions/loadingActions';var Dashboard=/*#__PURE__*/function(_Component){_inherits(Dashboard,_Component);var _super=_createSuper(Dashboard);function Dashboard(){var _this;_classCallCheck(this,Dashboard);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={products:[],// productsNotAdded: [],\nshufersalTotal:0,ramiLevyTotal:0,image:'',days:30};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(_this.props.loggedIn){_context.next=11;break;}if(!getCurrentUser()){_context.next=8;break;}_context.next=4;return _this.props.logIn(getCurrentUser().email,getCurrentUser().password);case 4:_this.props.setLoggedIn();_this.loadData(_this.state.days);_context.next=9;break;case 8:_this.props.history.push(LOGIN_PATH);case 9:_context.next=14;break;case 11:_context.next=13;return _this.props.logIn(getCurrentUser().email,getCurrentUser().password);case 13:_this.loadData(_this.state.days);case 14:case\"end\":return _context.stop();}}},_callee);}));_this.loadData=function(days){_this.props.load();var x=[];var y=[];axios.get('/products/'+getCurrentUser().email+'/'+days).then(function(data){_this.setState({products:data.data});var y=0,m=0;for(var _x in data.data){y+=data.data[_x].shufersalPrice;m+=data.data[_x].ramiLevyPrice;}_this.setState({shufersalTotal:y});_this.setState({ramiLevyTotal:m});_this.props.finishedLoading();});// axios.get('/products/notAdded/' + getCurrentUser().email).then(data => {\n//     this.setState({productsNotAdded: data.data})\n//   })\n};_this.handleDropdownChange=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(days){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this.setState({days:days});_this.loadData(days);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();return _this;}_createClass(Dashboard,[{key:\"render\",value:function render(){var _this2=this;if(this.props.loading)return/*#__PURE__*/_jsx(Spinner,{animation:\"border\",className:\"spinner\"});return/*#__PURE__*/_jsxs(Container,{className:\"margin-top-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"align-right\",children:\"\\u05DE\\u05D5\\u05E6\\u05E8\\u05D9\\u05DD \\u05E9\\u05E1\\u05E8\\u05E7\\u05EA\"}),/*#__PURE__*/_jsxs(Dropdown,{children:[/*#__PURE__*/_jsxs(Dropdown.Toggle,{variant:\"dark\",id:\"dropdown-basic\",children:[\"\\u05DC\\u05E4\\u05D9    \",this.state.days,\" \\u05D9\\u05DE\\u05D9\\u05DD \\u05D0\\u05D7\\u05E8\\u05D5\\u05E0\\u05D9\\u05DD\"]}),/*#__PURE__*/_jsxs(Dropdown.Menu,{children:[/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return _this2.handleDropdownChange(7);},children:\"\\u05DC\\u05E4\\u05D9 7 \\u05D9\\u05DE\\u05D9\\u05DD \\u05D0\\u05D7\\u05E8\\u05D5\\u05E0\\u05D9\\u05DD\"}),/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return _this2.handleDropdownChange(30);},children:\"\\u05DC\\u05E4\\u05D9 30 \\u05D9\\u05DE\\u05D9\\u05DD \\u05D0\\u05D7\\u05E8\\u05D5\\u05E0\\u05D9\\u05DD \"}),/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return _this2.handleDropdownChange(365);},children:\"\\u05DC\\u05E4\\u05D9 365 \\u05D9\\u05DE\\u05D9\\u05DD \\u05D0\\u05D7\\u05E8\\u05D5\\u05E0\\u05D9\\u05DD\"})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"align-right\",children:\"\\u05DC\\u05D0\\u05D9\\u05D6\\u05D5 \\u05E2\\u05D2\\u05DC\\u05D4 \\u05D4\\u05DE\\u05D5\\u05E6\\u05E8 \\u05E0\\u05DB\\u05E0\\u05E1 = \\uD83D\\uDED2\"}),/*#__PURE__*/_jsxs(Table,{bordered:true,hover:true,className:\"table-style\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"table-style-image\",children:\"\\u05E0\\u05D9\\u05EA\\u05DF \\u05DC\\u05D7\\u05E1\\u05D5\\u05DA\"}),/*#__PURE__*/_jsx(\"th\",{className:\"table-style-image\",children:\"\\u05E9\\u05D5\\u05E4\\u05E8\\u05E1\\u05DC\"}),/*#__PURE__*/_jsx(\"th\",{className:\"table-style-image\",children:\"\\u05E8\\u05DE\\u05D9 \\u05DC\\u05D5\\u05D9\"}),/*#__PURE__*/_jsx(\"th\",{className:\"table-style-image\",children:\"\\u05EA\\u05DE\\u05D5\\u05E0\\u05D4\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u05E9\\u05DD \\u05DE\\u05D5\\u05E6\\u05E8\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[this.state.products.map(function(current){var date=new Date(current.creationDate);var newDate=date.toLocaleDateString('he-IS');//   const greater = current.shufersalPrice < current.ramiLevyPrice ? 'shufersal' : 'ramiLevy'\n//greater === 'shufersal' ? 'red-style' : 'green-style'\nvar isSelectionShufersal=current.selection==='Shufersal'?true:false;var difference=(Math.round((current.shufersalPrice-current.ramiLevyPrice)*100)/100).toFixed(2);var message='';if(isSelectionShufersal){if(difference>0){message=\"\\u20AA \".concat(difference,\" \\u05E0\\u05D9\\u05EA\\u05DF \\u05DC\\u05D7\\u05E1\\u05D5\\u05DA \\u05D1\\u05E8\\u05DE\\u05D9 \\u05DC\\u05D5\\u05D9\");}}else{if(difference<0){message=\"\\u20AA \".concat(difference,\" \\u05E0\\u05D9\\u05EA\\u05DF \\u05DC\\u05D7\\u05E1\\u05D5\\u05DA \\u05D1\\u05E9\\u05D5\\u05E4\\u05E8\\u05E1\\u05DC\");}}return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{className:\"table-style-image\",children:[message,\" \"]}),/*#__PURE__*/_jsxs(\"td\",{className:(!isSelectionShufersal&&'gray-style')+' table-style-image',children:[current.shufersalPrice,\" \\u20AA \",isSelectionShufersal&&/*#__PURE__*/_jsx(\"div\",{children:\"\\uD83D\\uDED2\"})]}),/*#__PURE__*/_jsxs(\"td\",{className:(isSelectionShufersal&&'gray-style')+' table-style-image',children:[current.ramiLevyPrice,\" \\u20AA \",!isSelectionShufersal&&/*#__PURE__*/_jsx(\"div\",{children:\"\\uD83D\\uDED2\"})]}),/*#__PURE__*/_jsx(\"td\",{className:\"table-style-image\",children:/*#__PURE__*/_jsx(\"img\",{height:\"50px\",src:current.image})}),/*#__PURE__*/_jsx(\"td\",{children:current.name}),/*#__PURE__*/_jsx(\"td\",{children:newDate})]},current._id);}),/*#__PURE__*/_jsxs(\"tr\",{style:{borderTop:\"2px solid black\"},children:[/*#__PURE__*/_jsxs(\"td\",{children:[(Math.round(Math.abs(this.state.ramiLevyTotal-this.state.shufersalTotal)*100)/100).toFixed(2),\" \\u20AA :\\u05D4\\u05E4\\u05E8\\u05E9 \\u05DE\\u05D7\\u05D9\\u05E8 \\u05D1\\u05D9\\u05DF \\u05D4\\u05E1\\u05DC\\u05D9\\u05DD\"]}),/*#__PURE__*/_jsxs(\"td\",{className:this.state.shufersalTotal<this.state.ramiLevyTotal?'green-style':'red-style',children:[(Math.round(this.state.shufersalTotal*100)/100).toFixed(2),\" \\u20AA\"]}),/*#__PURE__*/_jsxs(\"td\",{className:this.state.shufersalTotal>this.state.ramiLevyTotal?'green-style':'red-style',children:[(Math.round(this.state.ramiLevyTotal*100)/100).toFixed(2),\" \\u20AA\"]})]},'total')]})]})]});}}]);return Dashboard;}(Component);var mapStateToProps=function mapStateToProps(state){return{currentUser:state.main.currentUser,loggedIn:state.main.loggedIn,loading:state.loading.loading};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{updateCurrentUser:function updateCurrentUser(user){return dispatch(mainActions.updateUsername(user));},setLoggedIn:function setLoggedIn(){return dispatch(mainActions.loggedIn());},load:function load(){return dispatch(loadingActions.loading());},finishedLoading:function finishedLoading(){return dispatch(loadingActions.finishedLoading());},logIn:function logIn(email,password){return dispatch(mainActions.logIn(email,password));}};};export default connect(mapStateToProps,mapDispatchToProps)(Dashboard);","map":{"version":3,"sources":["C:/Users/avivk/Documents/GitHub/scanlyreal/client/src/Components/Dashboard/Dashboard.js"],"names":["React","Component","connect","mainActions","promptActions","loadingActions","LOGIN_PATH","getCurrentUser","Container","Dropdown","Table","Spinner","axios","finishedLoading","Dashboard","state","products","shufersalTotal","ramiLevyTotal","image","days","componentDidMount","props","loggedIn","logIn","email","password","setLoggedIn","loadData","history","push","load","x","y","get","then","data","setState","m","shufersalPrice","ramiLevyPrice","handleDropdownChange","loading","map","current","date","Date","creationDate","newDate","toLocaleDateString","isSelectionShufersal","selection","difference","Math","round","toFixed","message","name","_id","borderTop","abs","mapStateToProps","currentUser","main","mapDispatchToProps","dispatch","updateCurrentUser","user","updateUsername"],"mappings":"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","sourcesContent":["import React,{Component} from 'react'\r\nimport { connect } from 'react-redux'\r\nimport * as mainActions from '../../Store/Actions/mainActions'\r\nimport * as promptActions from '../../Store/Actions/promptActions'\r\nimport * as loadingActions from '../../Store/Actions/loadingActions'\r\nimport { LOGIN_PATH } from '../../Constants/const';\r\nimport { getCurrentUser } from '../../UtilityFunctions/functions';\r\nimport { Container,Dropdown,Table,Spinner } from 'react-bootstrap';\r\nimport axios from 'axios'\r\nimport './dashboard.scss'\r\nimport { finishedLoading } from '../../Store/Actions/loadingActions';\r\n\r\nclass Dashboard extends Component {\r\n    state = {\r\n        products: [],\r\n        // productsNotAdded: [],\r\n        shufersalTotal: 0,\r\n        ramiLevyTotal: 0,\r\n        image: '',\r\n        days: 30,\r\n    }\r\n\r\n    componentDidMount = async () => {\r\n        // axios.get('https://chp.co.il/autocompletion/product_extended?term=8717163647226').then(data=> console.log(data.data[0].value))\r\n        if (!this.props.loggedIn) {\r\n            if (getCurrentUser()) {\r\n                await this.props.logIn(getCurrentUser().email,getCurrentUser().password)\r\n                this.props.setLoggedIn()\r\n                this.loadData(this.state.days)\r\n            }\r\n            else {\r\n                this.props.history.push(LOGIN_PATH)\r\n            }\r\n        }\r\n        else{\r\n            await this.props.logIn(getCurrentUser().email,getCurrentUser().password)\r\n            this.loadData(this.state.days)\r\n        }\r\n    }\r\n    loadData = (days) => {\r\n        this.props.load()\r\n        let x = []\r\n        let y = []\r\n        axios.get('/products/' + getCurrentUser().email + '/' + days).then(data => {\r\n            this.setState({products: data.data});\r\n            let y = 0, m = 0;\r\n            for(let x in data.data){\r\n                y += data.data[x].shufersalPrice;\r\n                m += data.data[x].ramiLevyPrice;\r\n            }\r\n            this.setState({shufersalTotal: y})\r\n            this.setState({ramiLevyTotal: m})\r\n            this.props.finishedLoading()\r\n\r\n    })\r\n        // axios.get('/products/notAdded/' + getCurrentUser().email).then(data => {\r\n        //     this.setState({productsNotAdded: data.data})\r\n\r\n        //   })\r\n    }\r\n\r\n    handleDropdownChange = async (days) => {\r\n        this.setState({days:days})\r\n        this.loadData(days)\r\n    }\r\n\r\n    render(){\r\n        if(this.props.loading)\r\n            return <Spinner animation=\"border\" className=\"spinner\" />\r\n        return(\r\n            <Container className=\"margin-top-container\">\r\n            <h1 className=\"align-right\">מוצרים שסרקת</h1>\r\n            <Dropdown>\r\n                        <Dropdown.Toggle variant=\"dark\" id=\"dropdown-basic\">\r\n                  לפי    {this.state.days} ימים אחרונים\r\n                        </Dropdown.Toggle>\r\n\r\n                        <Dropdown.Menu>\r\n                            <Dropdown.Item onClick={() => this.handleDropdownChange(7)}>לפי 7 ימים אחרונים</Dropdown.Item>\r\n                            <Dropdown.Item onClick={() => this.handleDropdownChange(30)}>לפי 30 ימים אחרונים </Dropdown.Item>\r\n                            <Dropdown.Item onClick={() => this.handleDropdownChange(365)}>לפי 365 ימים אחרונים</Dropdown.Item>\r\n                        </Dropdown.Menu>\r\n                    </Dropdown>\r\n                    <p className=\"align-right\">לאיזו עגלה המוצר נכנס = 🛒</p>\r\n\r\n                                <Table bordered hover className=\"table-style\">\r\n  <thead>\r\n    <tr>\r\n      <th className=\"table-style-image\">ניתן לחסוך</th>\r\n      <th className=\"table-style-image\">שופרסל</th>\r\n      <th className=\"table-style-image\">רמי לוי</th>\r\n      <th className=\"table-style-image\">תמונה</th>\r\n      <th>שם מוצר</th>\r\n      <th>תאריך</th>\r\n\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n      {this.state.products.map((current) => {\r\n          const date = new Date(current.creationDate);\r\n          const newDate = date.toLocaleDateString('he-IS');\r\n        //   const greater = current.shufersalPrice < current.ramiLevyPrice ? 'shufersal' : 'ramiLevy'\r\n          //greater === 'shufersal' ? 'red-style' : 'green-style'\r\n          const isSelectionShufersal = current.selection === 'Shufersal' ? true : false;\r\n          const difference = (Math.round((current.shufersalPrice-current.ramiLevyPrice) * 100) / 100).toFixed(2);\r\n          let message = ''\r\n          if(isSelectionShufersal){\r\n            if(difference>0){\r\n                message = `₪ ${difference} ניתן לחסוך ברמי לוי`\r\n            }\r\n            \r\n          }\r\n          else{\r\n            if(difference<0){\r\n                message = `₪ ${difference} ניתן לחסוך בשופרסל`\r\n            }\r\n            \r\n          }\r\n          return <tr key={current._id}>\r\n          <td className='table-style-image'>{message} </td>\r\n          <td className={(!isSelectionShufersal && 'gray-style') + ' table-style-image'}>{current.shufersalPrice} ₪ {isSelectionShufersal && <div>🛒</div>}</td>\r\n      <td className={(isSelectionShufersal && 'gray-style') + ' table-style-image'}>{current.ramiLevyPrice} ₪ {!isSelectionShufersal && <div>🛒</div>}</td>\r\n          <td className=\"table-style-image\"><img height=\"50px\" src={current.image}/></td>\r\n          <td>{current.name}</td>\r\n          <td>{newDate}</td>\r\n\r\n        </tr>\r\n                      \r\n      })}\r\n    <tr key='total' style={{borderTop: \"2px solid black\"}}>\r\n    <td>{(Math.round((Math.abs(this.state.ramiLevyTotal-this.state.shufersalTotal)) * 100) / 100).toFixed(2)} ₪ :הפרש מחיר בין הסלים</td>\r\n\r\n          <td className={this.state.shufersalTotal < this.state.ramiLevyTotal ? 'green-style' : 'red-style'}>{(Math.round(this.state.shufersalTotal * 100) / 100).toFixed(2)} ₪</td>\r\n          <td className={this.state.shufersalTotal > this.state.ramiLevyTotal ? 'green-style' : 'red-style'}>{(Math.round(this.state.ramiLevyTotal * 100) / 100).toFixed(2)} ₪</td>\r\n        </tr>\r\n  </tbody>\r\n</Table>\r\n{/* <h1 style={{textAlign:\"right\"}}>מוצרים שלא נכנסו לעגלה</h1>\r\n<Table striped bordered hover variant=\"dark\" className=\"table-style\">\r\n  <thead>\r\n    <tr>\r\n      <th>תמונה</th>\r\n      <th>שם מוצר</th>\r\n      <th>תאריך</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n      {this.state.productsNotAdded.map(current => {\r\n                    const date = new Date(current.creationDate);\r\n                    const newDate = date.toLocaleDateString('he-IS');          \r\n          return <tr key={current._id}>\r\n                        <td><img height=\"50px\" src={current.image}/></td>\r\n          <td>{current.name}</td>\r\n          <td>{newDate}</td>\r\n\r\n        </tr>\r\n      })}\r\n    \r\n  </tbody>\r\n</Table> */}\r\n\r\n\r\n</Container>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        currentUser: state.main.currentUser,\r\n        loggedIn: state.main.loggedIn,\r\n        loading: state.loading.loading\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        updateCurrentUser: (user) => dispatch(mainActions.updateUsername(user)),\r\n        setLoggedIn: () => dispatch(mainActions.loggedIn()),\r\n        load: () => dispatch(loadingActions.loading()),\r\n        finishedLoading: () => dispatch(loadingActions.finishedLoading()),\r\n        logIn: (email, password) => dispatch(mainActions.logIn(email, password))\r\n\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Dashboard);"]},"metadata":{},"sourceType":"module"}